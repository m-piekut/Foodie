(this.webpackJsonpfoodie=this.webpackJsonpfoodie||[]).push([[0],{71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var c=n(3),s=n(0),a=n.n(s),i=n(22),r=n.n(i),o=n(23),l=(n(71),n(72),n(73),n(74),n(75),function(){return Object(c.jsx)("h1",{className:"h1",children:"Foodie"})}),d=function(){return Object(c.jsxs)("header",{className:"header",children:[Object(c.jsx)(l,{}),Object(c.jsx)("p",{className:"header__p",children:"Ucztujcie razem"})]})},u=n(5),j=n(9),b=n(16),f=(b.a.initializeApp({apiKey:"AIzaSyAK2vuEi_fmyf0qGTVhn5K0vY7J6xWr0-o",authDomain:"foodie-ccee4.firebaseapp.com",databaseURL:"https://foodie-ccee4-default-rtdb.firebaseio.com",projectId:"foodie-ccee4",storageBucket:"foodie-ccee4.appspot.com",messagingSenderId:"287004675749",appId:"1:287004675749:web:736e7ded380b68da27c74c",measurementId:"G-3EQLXB8ZK4"}),b.a.firestore()),m=b.a.auth(),O=b.a.storage(),h=function(){return Object(c.jsxs)("div",{className:"lds-ripple",children:[Object(c.jsx)("div",{}),Object(c.jsx)("div",{})]})},p=n(14),x=function(){return Object(c.jsx)(p.b,{to:"../dinners",className:"backToDinners primary-btn",children:"Uczty"})},g=function(){return Object(c.jsxs)("div",{className:"page404",children:[Object(c.jsx)("p",{className:"page404__code",children:"404"}),Object(c.jsx)("p",{className:"page404__text",children:"Nie znaleziono strony"}),Object(c.jsx)(x,{})]})},_=function(){var e=Object(j.g)(),t=Object(s.useState)(null),n=Object(u.a)(t,2),a=n[0],i=n[1],r=Object(o.c)((function(e){return e.takeData})).loggedUserId;Object(s.useEffect)((function(){return f.collection("users").doc(r).onSnapshot((function(e){i(e.data())})),function(){}}),[r]);return Object(c.jsx)("button",{className:"add-photos",onClick:function(){return f.collection("users").doc("".concat(e.id)).collection("invites").doc(r).set({from:r,username:a.username,avatar:a.avatar}),void console.log(1)},children:Object(c.jsx)("i",{className:"fas fa-user-plus add-photos__icon"})})},v=function(e){var t=e.from,n=e.profileId;return Object(c.jsx)("button",{className:"friends__delete",onClick:function(){return f.collection("users").doc(n).collection("friends").doc(t).delete().then((function(){alert("usuni\u0119to znajomego"),f.collection("users").doc(n).update({friends:b.a.firestore.FieldValue.increment(-1)})})),void f.collection("users").doc(t).collection("friends").doc(n).delete().then((function(){alert("usuni\u0119to znajomego"),f.collection("users").doc(t).update({friends:b.a.firestore.FieldValue.increment(-1)})}))},children:Object(c.jsx)("i",{className:"fas fa-times"})})},N=function(e){var t=e.isItYourProfile,n=Object(j.g)(),a=Object(s.useState)(null),i=Object(u.a)(a,2),r=i[0],o=i[1];return Object(s.useEffect)((function(){return f.collection("users").doc(n.id).collection("friends").onSnapshot((function(e){o(e.docs.map((function(e){return{id:e.id,friend:e.data()}})))})),function(){o(null)}}),[n]),Object(c.jsx)("div",{className:"friends",children:r&&Object(c.jsxs)("div",{className:"friends__wrapper",children:[Object(c.jsx)("h3",{className:"friends__title",children:"Znajomi"}),r.map((function(e){var s=e.id,a=e.friend;return Object(c.jsxs)("div",{className:"friends__listItem",children:[Object(c.jsx)("img",{className:"friends__avatar avatar",src:a.avatar,alt:""}),Object(c.jsxs)("div",{className:"friends__right",children:[Object(c.jsx)("p",{children:Object(c.jsxs)(p.b,{to:"/users/".concat(a.from),children:[a.username," "]})}),t&&Object(c.jsx)(v,{from:a.from,profileId:n.id})]})]},s)}))]})})},y=function(e){var t=e.showDinners,n=Object(j.g)().id,a=Object(s.useState)(null),i=Object(u.a)(a,2),r=i[0],o=i[1];return Object(s.useEffect)((function(){return f.collection("users").doc(n).collection("dinners").onSnapshot((function(e){o(e.docs.map((function(e){return{id:e.id,dinner:e.data()}})))})),function(){}}),[n]),Object(s.useEffect)((function(){r&&r.forEach((function(e){new Date(new Date("".concat(e.dinner.date,"T").concat(e.dinner.time)).getTime())<(new Date).getTime()&&f.collection("users").doc(n).collection("dinners").doc(e.id).delete().then(f.collection("users").doc(n).update({dinners:b.a.firestore.FieldValue.increment(-1)}))}))}),[r,t,n]),Object(c.jsxs)("div",{className:"profileDinners",children:[Object(c.jsx)("h3",{className:"profileDinners__title",children:"Twoje Uczty"}),r&&Object(c.jsx)("div",{className:"profileDinners__wrapper",children:r&&r.map((function(e){var t=e.id,n=e.dinner;return Object(c.jsx)(p.b,{to:"/dinners/".concat(t),children:Object(c.jsxs)("div",{className:"profileDinners__listItem",children:[Object(c.jsxs)("div",{className:"profileDinners__upper",children:[Object(c.jsx)("p",{className:"dinnerProfile__date",children:n.date}),Object(c.jsx)("p",{className:"dinnerProfile__time",children:n.time})]}),Object(c.jsxs)("div",{className:"profileDinners__down",children:[Object(c.jsx)("p",{className:"dinnerProfile__date",children:n.city}),Object(c.jsx)("p",{className:"dinnerProfile__time",children:n.name})]})]})},t)}))})]})},S=function(e){var t=e.userProfile,n=e.userImages,a=e.userId,i=Object(s.useState)(!1),r=Object(u.a)(i,2),o=r[0],l=r[1],d=Object(s.useState)(!1),j=Object(u.a)(d,2),b=j[0],O=j[1],p=Object(s.useState)(!0),x=Object(u.a)(p,2),v=x[0],S=x[1],w=Object(s.useState)(!0),k=Object(u.a)(w,2),z=k[0],C=k[1],I=Object(s.useState)(!0),D=Object(u.a)(I,2),U=D[0],E=D[1];return Object(s.useEffect)((function(){E(!t)}),[t,a]),Object(s.useEffect)((function(){return m.X?(f.collection("users").doc(a).collection("invites").doc(m.X).onSnapshot((function(e){S(e.data())})),f.collection("users").doc(a).collection("friends").doc(m.X).onSnapshot((function(e){C(e.data())}))):(C(!1),S(!1)),function(){C(null),S(null)}}),[a]),U?Object(c.jsx)(h,{}):t?Object(c.jsxs)("div",{className:"user-profile",children:[Object(c.jsxs)("div",{className:"user-info",children:[Object(c.jsx)("img",{className:"user-info__image",src:t.avatar,alt:""}),Object(c.jsxs)("div",{className:"user-info__personal",children:[Object(c.jsxs)("div",{className:"user-info__personal-upper",children:[Object(c.jsx)("p",{className:"user-info__username",children:t.username}),Object(c.jsxs)("div",{className:"user-info__emotes",children:[Object(c.jsxs)("div",{className:"user-info__emotes-item user-info__emotes-item--middle",onClick:function(){O(!b),l(!1)},children:[Object(c.jsx)("i",{className:"fas fa-utensils"}),Object(c.jsx)("p",{children:t.dinners})]}),Object(c.jsxs)("div",{className:"user-info__emotes-item user-info__emotes-item",onClick:function(){l(!o),O(!1)},children:[Object(c.jsx)("i",{className:"fas fa-user-friends"}),Object(c.jsx)("p",{children:t.friends})]})]}),o&&Object(c.jsx)(N,{}),b&&Object(c.jsx)(y,{showDinners:b})]}),Object(c.jsx)("p",{className:"user-info__personal-description",children:t.description})]}),!!m.X&&(v||z?"juz zaprosi\u0142es/obserwujesz":Object(c.jsx)(_,{userProfile:t}))]}),n&&Object(c.jsx)("div",{className:"user-profile__images-box",children:n.map((function(e){var t=e.id,n=e.image;return Object(c.jsx)("div",{className:"user-profile__image",children:Object(c.jsx)("img",{src:n.image,alt:""})},t)}))})]}):Object(c.jsx)(g,{})},w=n(101),k=function(e){var t=e.id,n=Object(s.useState)(!1),a=Object(u.a)(n,2),i=a[0],r=a[1],o=Object(s.useState)(0),l=Object(u.a)(o,2),d=l[0],j=l[1],b=Object(s.useState)(null),m=Object(u.a)(b,2),h=m[0],p=m[1];return Object(c.jsxs)("div",{className:"add-photo-form",children:[Object(c.jsxs)("button",{className:"add-photos",onClick:function(){return r(!0)},children:[Object(c.jsx)("i",{className:"fas fa-image add-photos__icon"}),"Dodaj zdj\u0119cie"]}),Object(c.jsx)(w.a,{open:i,onClose:function(){return r(!1)},children:Object(c.jsxs)("form",{className:"new-dinner",onSubmit:function(e){e.preventDefault();var n=h.name,c=n.lastIndexOf(".")+1,s=n.substr(c,n.length).toLowerCase();"jpg"===s||"jpeg"===s||"png"===s?O.ref("".concat(t,"/Images/").concat(h.name)).put(h).on("stage_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);j(t),100===t&&setTimeout((function(){r(!1)}),500)}),(function(e){console.log(e),alert(e.message)}),(function(){O.ref("".concat(t,"/Images")).child("".concat(h.name)).getDownloadURL().then((function(e){f.collection("users").doc(t).collection("images").add({image:e,name:h.name}),j(0),p(null)}))})):alert("To nie jest zdj\u0119cie")},children:[Object(c.jsx)("h3",{children:"Tw\xf3je zdj\u0119cie"}),Object(c.jsxs)("p",{className:"user-profile__form-procentage",children:[d,"%"]}),Object(c.jsx)("progress",{className:"user-profile__form-progress",value:[d],max:"100"}),Object(c.jsx)("input",{required:!0,className:"user-profile__form-input",type:"file",accept:"image/*",onChange:function(e){e.target.files[0]&&(p(e.target.files[0]),console.log(h))}}),Object(c.jsx)("button",{className:"primary-btn",children:"Wyslij"})]})})]})},z=function(e){var t=e.imageId,n=e.imageName,s=Object(j.g)().id,a=O.ref("".concat(s,"/Images/")).child("".concat(n));return Object(c.jsx)("button",{className:"user-profile__deletePhoto",onClick:function(){a.delete().then((function(){console.log("usuni\u0119to zdj\u0119cie z bazy")})).catch((function(e){alert(e)})),f.collection("users").doc(s).collection("images").doc(t).delete().then((function(){console.log("usuni\u0119to link do zdj\u0119cia")})).catch((function(e){console.log(e)}))},children:Object(c.jsx)("i",{className:"far fa-trash-alt"})})},C=function(e){var t=e.from,n=e.yourId,s=e.avatar,a=e.username,i=Object(o.c)((function(e){return e.takeData})),r=i.loggedAvatar,l=i.loggedUserUsername;return Object(c.jsxs)("div",{className:"friends__buttons",children:[Object(c.jsx)("button",{onClick:function(){f.collection("users").doc(n).collection("friends").doc(t).set({from:t,avatar:s,username:a}).then(f.collection("users").doc(t).collection("friends").doc(n).set({from:n,avatar:r,username:l}).then(f.collection("users").doc(t).update({friends:b.a.firestore.FieldValue.increment(1)}))).then(f.collection("users").doc(n).collection("invites").doc(t).delete().then((function(){alert("Przyj\u0119to zaproszenie")})).catch((function(e){console.log(e)}))),f.collection("users").doc(n).update({friends:b.a.firestore.FieldValue.increment(1)})},children:Object(c.jsx)("i",{className:"fas fa-check"})}),Object(c.jsx)("button",{onClick:function(){f.collection("users").doc(n).collection("invites").doc(t).delete().then((function(){alert("nie przyj\u0119to zaproszenia")})).catch((function(e){console.log(e)}))},children:Object(c.jsx)("i",{className:"fas fa-times"})})]})},I=function(e){var t=e.id,n=t,a=Object(s.useState)(null),i=Object(u.a)(a,2),r=i[0],o=i[1];return Object(s.useEffect)((function(){return f.collection("users").doc(t).collection("invites").onSnapshot((function(e){o(e.docs.map((function(e){return{id:e.id,invite:e.data()}})))})),function(){o(null)}}),[t]),Object(c.jsxs)("div",{className:"friends",children:[Object(c.jsx)("h3",{className:"friends_title",children:"Zaproszenia"}),r&&0!==r.length?Object(c.jsx)("div",{className:"friends__wrapper",children:r.map((function(e){var t=e.id,s=e.invite;return Object(c.jsxs)("div",{className:"friends__listItem",children:[Object(c.jsx)("img",{className:"friends__avatar avatar",src:s.avatar,alt:""}),Object(c.jsxs)("div",{className:"friends__right",children:[Object(c.jsx)("p",{children:Object(c.jsxs)(p.b,{to:"/users/".concat(s.from),children:[s.username," "]})}),Object(c.jsx)(C,{from:s.from,yourId:n,avatar:s.avatar,username:s.username})]})]},t)}))}):Object(c.jsx)("p",{children:"brak zaprosze\u0144"})]})},D=function(e){var t=e.userProfile,n=e.userImages,a=Object(o.c)((function(e){return e.takeData})).loggedUserId,i=Object(s.useState)(!1),r=Object(u.a)(i,2),l=r[0],d=r[1],j=Object(s.useState)(!1),b=Object(u.a)(j,2),m=b[0],h=b[1],p=Object(s.useState)(!1),x=Object(u.a)(p,2),g=x[0],_=x[1],v=Object(s.useState)(""),S=Object(u.a)(v,2),C=S[0],D=S[1],U=Object(s.useState)(""),E=Object(u.a)(U,2),T=E[0],X=E[1],A=Object(s.useState)(null),L=Object(u.a)(A,2),P=L[0],F=L[1],q=Object(s.useState)(!1),M=Object(u.a)(q,2),V=M[0],B=M[1],W=Object(s.useState)(!1),Z=Object(u.a)(W,2),J=Z[0],K=Z[1];Object(s.useEffect)((function(){return D(t.quote),X(t.description),F(f.collection("users").doc(a)),function(){D(""),X(null),F(null)}}),[t,a]);var G=Object(s.useState)(null),R=Object(u.a)(G,2),Y=R[0],Q=R[1],H=Object(s.useState)(0),$=Object(u.a)(H,2),ee=$[0],te=$[1];return Object(c.jsxs)("div",{className:"user-profile",children:[Object(c.jsxs)("div",{className:"user-info",children:[Object(c.jsx)("img",{className:"user-info__image user-info__edit",src:t.avatar,alt:"",onClick:function(){return h(!0)}}),Object(c.jsxs)("div",{className:"user-info__personal",children:[Object(c.jsxs)("div",{className:"user-info__personal-upper",children:[Object(c.jsx)("p",{className:"user-info__username",children:t.username}),Object(c.jsxs)("div",{className:"user-info__emotes",children:[Object(c.jsxs)("div",{className:"user-info__emotes-item user-info__emotes-item--middle",onClick:function(){K(!J),B(!1)},children:[Object(c.jsx)("i",{className:"fas fa-utensils"}),Object(c.jsx)("p",{children:t.dinners})]}),Object(c.jsxs)("div",{className:"user-info__emotes-item user-info__emotes-item",onClick:function(){B(!V),K()},children:[Object(c.jsx)("i",{className:"fas fa-user-friends"}),Object(c.jsx)("p",{children:t.friends})]})]}),V&&[Object(c.jsx)(I,{id:a},"1"),Object(c.jsx)(N,{isItYourProfile:!0},"2")],J&&Object(c.jsx)(y,{showDinners:J})]}),Object(c.jsx)("p",{className:"user-info__personal-description user-info__edit",onClick:function(){return _(!0)},children:t.description})]}),Object(c.jsx)(k,{id:a})]}),n&&Object(c.jsx)("div",{className:"user-profile__images-box",children:n.map((function(e){var t=e.id,n=e.image;return Object(c.jsxs)("div",{className:"user-profile__image",children:[Object(c.jsx)("img",{src:n.image,alt:""}),Object(c.jsx)(z,{imageId:t,imageName:n.name})]},t)}))}),Object(c.jsx)(w.a,{open:l,onClose:function(){return d(!1)},children:Object(c.jsxs)("form",{className:"new-dinner",onSubmit:function(e){return function(e){e.preventDefault(),d(!1),P.update({quote:C})}(e)},children:[Object(c.jsx)("h3",{children:"Tw\xf3j cytat"}),Object(c.jsx)("input",{className:"user-profile__form-input",type:"text",value:C,onChange:function(e){return D(e.target.value)}}),Object(c.jsx)("button",{className:"primary-btn",children:"Wyslij"})]})}),Object(c.jsx)(w.a,{open:m,onClose:function(){return h(!1)},children:Object(c.jsxs)("form",{className:"new-dinner",children:[Object(c.jsx)("h3",{children:"Tw\xf3je zdj\u0119cie"}),Object(c.jsx)("progress",{className:"user-profile__form-progress",value:[ee],max:"100"}),Object(c.jsx)("input",{className:"user-profile__form-input",type:"file",accept:"image/*",onChange:function(e){e.target.files[0]&&Q(e.target.files[0])}}),Object(c.jsx)("button",{onClick:function(e){return function(e){e.preventDefault();var t=Y.name,n=t.lastIndexOf(".")+1,c=t.substr(n,t.length).toLowerCase();"jpg"===c||"jpeg"===c||"png"===c?O.ref("".concat(a,"/avatar")).put(Y).on("stage_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);te(t),100===t&&setTimeout((function(){h(!1)}),500)}),(function(e){console.log(e),alert(e.message)}),(function(){O.ref("".concat(a)).child("avatar").getDownloadURL().then((function(e){P.update({avatar:e}),te(0),Q(null)}))})):alert("To nie jest zdj\u0119cie")}(e)},className:"primary-btn",children:"Wyslij"})]})}),Object(c.jsx)(w.a,{open:g,onClose:function(){return _(!1)},children:Object(c.jsxs)("form",{className:"new-dinner",onSubmit:function(e){return function(e){e.preventDefault(),_(!1),P.update({description:T})}(e)},children:[Object(c.jsx)("h3",{children:"Tw\xf3j opis"}),Object(c.jsx)("textarea",{className:"user-profile__form-textarea",minLength:"1",maxLength:"300",type:"text",value:T,onChange:function(e){return X(e.target.value)}}),Object(c.jsx)("button",{className:"primary-btn",children:"Wyslij"})]})})]})},U=Object(j.h)((function(){var e=Object(j.g)().id,t=Object(s.useState)(""),n=Object(u.a)(t,2),a=n[0],i=n[1],r=Object(s.useState)(),o=Object(u.a)(r,2),l=o[0],d=o[1],b=Object(s.useState)(null),O=Object(u.a)(b,2),p=O[0],x=O[1],_=Object(s.useState)(!0),v=Object(u.a)(_,2),N=v[0],y=v[1];return Object(s.useEffect)((function(){return m.onAuthStateChanged((function(t){t&&(e===m.X?d(!0):d(!1))})),f.collection("users").doc(e).onSnapshot((function(e){i(e.data()),y(!1)})),f.collection("users").doc(e).collection("images").onSnapshot((function(e){x(e.docs.map((function(e){return{id:e.id,image:e.data()}})))})),function(){d(null),i(null)}}),[e]),Object(s.useEffect)((function(){null===a||void 0===a?i(!1):a&&y(!1)}),[a,e]),N?Object(c.jsx)(h,{}):a?l?Object(c.jsx)(D,{userProfile:a,userImages:p}):Object(c.jsx)(S,{userProfile:a,userImages:p,userId:e}):Object(c.jsx)(g,{})})),E=function(){var e=Object(s.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],i=Object(s.useState)(""),r=Object(u.a)(i,2),l=r[0],d=r[1],j=Object(s.useState)(""),O=Object(u.a)(j,2),h=O[0],p=O[1],x=Object(s.useState)(""),g=Object(u.a)(x,2),_=g[0],v=g[1],N=Object(s.useState)(""),y=Object(u.a)(N,2),S=y[0],k=y[1],z=Object(s.useState)(null),C=Object(u.a)(z,2),I=C[0],D=C[1],U=Object(s.useState)(null),E=Object(u.a)(U,2),T=E[0],X=E[1],A=Object(s.useState)(!1),L=Object(u.a)(A,2),P=L[0],F=L[1],q=Object(o.c)((function(e){return e.takeData})).loggedUserId;Object(s.useEffect)((function(){return m.onAuthStateChanged((function(e){D(e?e.displayName:null)})),f.collection("users").doc(m.X).onSnapshot((function(e){X(e.data().avatar)})),function(){X(null)}}),[]);return Object(c.jsxs)("div",{className:"make-dinner",children:[Object(c.jsx)(w.a,{open:P,onClose:function(){return F(!1)},children:Object(c.jsxs)("form",{className:"new-dinner",onSubmit:function(e){return function(e){e.preventDefault();var t={city:n,name:h,address:l,date:_,time:S};console.log(t),n.length<36&&h.length<36&&l.length<36?(f.collection("diners").add({city:n,address:l,name:h,date:_,time:S}).then((function(e){console.log("Document written with ID: ",e.id),f.collection("diners").doc(e.id).collection("dinnerMaker").add({avatar:T,username:I,id:q}),f.collection("users").doc(q).collection("dinners").doc(e.id).set({date:_,name:h,time:S,city:n,id:e.id}),f.collection("users").doc(q).update({dinners:b.a.firestore.FieldValue.increment(1)})})).catch((function(e){console.error("Error adding document: ",e)})),F(!1)):alert("maksymalna ilo\u015b\u0107 znak\xf3w to 35")}(e)},children:[Object(c.jsx)("h3",{children:"Stw\xf3rz uczt\u0119"}),Object(c.jsxs)("div",{className:"new-dinner__input new-dinner__input--date",children:[Object(c.jsx)("label",{htmlFor:"date",children:"Data uczty"}),Object(c.jsx)("input",{id:"date",type:"date",required:!0,placeholder:"data",value:_,onChange:function(e){return v(e.target.value)}})]}),Object(c.jsxs)("div",{className:"new-dinner__input new-dinner__input--time",children:[Object(c.jsx)("label",{htmlFor:"time",children:"Godzina uczty"}),Object(c.jsx)("input",{id:"time",type:"time",required:!0,placeholder:"godzina",onChange:function(e){return k(e.target.value)}})]}),Object(c.jsx)("input",{className:"new-dinner__input new-dinner__input--city",type:"text",placeholder:"Miasto",required:!0,value:n,maxLength:"35",onChange:function(e){return a(e.target.value)}}),Object(c.jsx)("input",{className:"new-dinner__input new-dinner__input--name",required:!0,type:"text",placeholder:"Nazwa miejsca",maxLength:"35",onChange:function(e){return p(e.target.value)}}),Object(c.jsx)("input",{className:"new-dinner__input new-dinner__input--address",required:!0,type:"text",placeholder:"Adres uczty",maxLength:"35",onChange:function(e){return d(e.target.value)}}),Object(c.jsx)("button",{className:"primary-btn",children:"Wyslij"})]})}),Object(c.jsx)("button",{className:"primary-btn new-dinner__addButton",onClick:function(){return F(!0)},children:"Dodaj uczt\u0119"})]})},T=function(e){var t=e.searchValue,n=e.name,a=e.address,i=e.date,r=e.time,o=e.city,l=e.dinnerId,d=Object(s.useState)([]),j=Object(u.a)(d,2),b=j[0],m=j[1],O=Object(s.useState)([]),h=Object(u.a)(O,2),x=h[0],g=h[1],_=new Date("".concat(i,"T").concat(r)).getTime(),v=(new Date).getTime();return Object(s.useEffect)((function(){_<v&&f.collection("diners").doc(l).delete()}),[l,_,v]),Object(s.useEffect)((function(){var e=f.collection("diners").doc(l).collection("invited");return f.collection("diners").doc(l).collection("dinnerMaker").onSnapshot((function(e){m(e.docs.map((function(e){return{avatars:e.data(),id:e.id}})))})),e.onSnapshot((function(e){g(e.docs.map((function(e){return{avatars:e.data(),id:e.id}})))})),function(){m(null),g(null)}}),[l]),-1!==o.toLowerCase().search(t.toLowerCase())&&Object(c.jsx)(p.b,{to:"/dinners/".concat(l),children:Object(c.jsxs)("div",{className:"dinner-list__box",children:[Object(c.jsxs)("div",{className:"dinner-list__up",children:[Object(c.jsxs)("div",{className:"dinner-list__left",children:[Object(c.jsx)("h4",{className:"dinner-list__city",children:o}),Object(c.jsxs)("p",{className:"dinner-list__date",children:[i," ",r]})]}),x&&Object(c.jsxs)("div",{className:"dinner-list__avatars",children:[b.map((function(e){var t=e.avatars,n=e.id;return Object(c.jsx)("img",{className:"avatar",src:t.avatar,alt:"dinner-maker-avatar"},n)})),x.map((function(e){var t=e.avatars,n=e.id;return Object(c.jsx)("img",{className:"avatar",src:t.avatar,alt:"dinner-guest-avatar"},n)}))]})]}),Object(c.jsx)("div",{className:"dinner-list__down",children:Object(c.jsxs)("div",{className:"dinner-list__left",children:[Object(c.jsx)("p",{className:"dinner-list__place",children:n}),Object(c.jsx)("p",{className:"dinner-list__address",children:a})]})})]},l)})},X=function(){var e=document.querySelector(".dinner-list__search-icon"),t=document.querySelector(".dinner-list__search-bar"),n=document.querySelector(".dinner-list__search"),a=Object(s.useState)([]),i=Object(u.a)(a,2),r=i[0],o=i[1],l=Object(s.useState)(null),d=Object(u.a)(l,2),j=d[0],b=d[1],O=Object(s.useState)(""),h=Object(u.a)(O,2),p=h[0],x=h[1];return Object(s.useEffect)((function(){return f.collection("diners").onSnapshot((function(e){o(e.docs.map((function(e){return{id:e.id,dinner:e.data()}})))})),m.onAuthStateChanged((function(e){b(e?e.displayName:null)})),function(){o(null)}}),[]),r&&Object(c.jsxs)("div",{className:"dinner-list",children:[Object(c.jsx)("h3",{className:"dinner-list__header",children:"Lista uczt:"}),Object(c.jsxs)("div",{type:"text",className:"dinner-list__search",children:[Object(c.jsx)("input",{className:"dinner-list__search-bar",id:"testing",placeholder:"Miasto",type:"text",value:p,onChange:function(e){return x(e.target.value)}}),Object(c.jsx)("button",{className:"dinner-list__search-icon rotateBack",onClick:function(){return e.classList.toggle("rotate"),e.classList.toggle("rotateBack"),t.classList.toggle("show-search-bar"),n.classList.toggle("show-search"),void x("")},children:Object(c.jsx)("label",{htmlFor:"testing",children:Object(c.jsx)("i",{className:"fas fa-search"})})})]}),j?Object(c.jsx)(E,{}):Object(c.jsx)("p",{children:"Aby utworzy\u0107 uczt\u0119 musisz si\u0119 zalogowa\u0107"}),r.map((function(e){var t=e.id,n=e.dinner;return Object(c.jsx)(T,{searchValue:p,city:n.city,date:n.date,time:n.time,address:n.address,name:n.name,dinnerId:t},t)}))]})},A=function(e){var t=e.id,n=Object(j.g)();return Object(c.jsx)("button",{className:"leaveButton",onClick:function(){return f.collection("diners").doc(n.id).collection("invited").doc(t).delete().then((function(){console.log("usunieto")})).catch((function(e){console.log(e)})),f.collection("users").doc(m.X).collection("dinners").doc(n.id).delete(),void f.collection("users").doc(m.X).update({dinners:b.a.firestore.FieldValue.increment(-1)})},children:"Opu\u015b\u0107"})},L=function(e){var t=e.date,n=e.time,a=e.id,i=Object(j.f)(),r=Object(s.useState)(0),o=Object(u.a)(r,2),l=o[0],d=o[1],b=Object(s.useState)(0),m=Object(u.a)(b,2),O=m[0],h=m[1];setInterval((function(){d((new Date).getTime())}),1e3);var p=new Date("".concat(t,"T").concat(n)).getTime();return Object(s.useEffect)((function(){return h(p-l),function(){h("")}}),[l,p]),Object(s.useEffect)((function(){O<0&&f.collection("diners").doc(a).delete().then((function(){i.push("/dinners")}))}),[O,a,i]),Object(c.jsxs)("div",{className:"timer-box",children:[Object(c.jsx)("p",{className:"timer-box__header",children:"Uczta za:"}),Object(c.jsxs)("p",{className:"timer-box__info",children:[Math.floor(O/36e5)," godziny ",Math.floor(O%36e5/6e4)," minuty ",(O%36e5%6e4/1e3).toFixed(0)," sekundy"]})]})},P=function(){var e=Object(j.g)().id,t=Object(s.useState)(null),n=Object(u.a)(t,2),a=n[0],i=n[1],r=Object(s.useState)([]),l=Object(u.a)(r,2),d=l[0],O=l[1],x=Object(s.useState)(null),_=Object(u.a)(x,2),v=_[0],N=_[1],y=Object(s.useState)(null),S=Object(u.a)(y,2),w=S[0],k=S[1],z=Object(s.useState)(null),C=Object(u.a)(z,2),I=C[0],D=C[1],U=Object(s.useState)(!1),E=Object(u.a)(U,2),T=E[0],X=E[1],P=Object(s.useState)(!0),F=Object(u.a)(P,2),q=F[0],M=F[1],V=Object(s.useState)(!1),B=Object(u.a)(V,2),W=B[0],Z=B[1],J=Object(s.useState)(!0),K=Object(u.a)(J,2),G=K[0],R=K[1],Y=Object(o.c)((function(e){return e.takeData})).loggedUserId;return Object(s.useEffect)((function(){m.onAuthStateChanged((function(e){e?(k(e.displayName),D(e.X.X),f.collection("users").doc(e.X.X).onSnapshot((function(e){Z(e.data().avatar)}))):(k(null),D(null))}));var t=f.collection("diners").doc(e);return f.collection("diners").doc(e).collection("dinnerMaker").onSnapshot((function(e){N(e.docs.map((function(e){return{maker:e.data(),id:e.id}})))})),t.collection("invited").onSnapshot((function(e){O(e.docs.map((function(e){return{id:e.id,invitedUser:e.data()}})))})),t.get().then((function(e){e.exists?(i(e.data()),R(!1)):(console.log("No such document!"),R(!1))})).catch((function(e){console.log("Error getting document:",e)})),function(){k(null),D(null),i(null),R(null),O(null),N(null)}}),[e]),Object(s.useEffect)((function(){return v&&(v[0].maker.id===Y?M(!0):M(!1)),function(){M(null)}}),[v,Y]),Object(s.useEffect)((function(){if(d)for(var e=0;e<d.length;e++){if(d[e].invitedUser.id===m.X){X(!0);break}X(!1)}return function(){X(null)}}),[d]),G?Object(c.jsx)(h,{}):a?Object(c.jsxs)("div",{className:"dinner-info",children:[Object(c.jsx)(L,{date:a.date,time:a.time,id:e}),Object(c.jsxs)("div",{className:"dinner-info__mainInfo",children:[Object(c.jsx)("h2",{className:"dinner-info__city",children:a.city}),Object(c.jsxs)("p",{className:"dinner-info__date",children:[a.date," ",a.time]}),Object(c.jsx)("p",{className:"dinner-info__name",children:a.name}),Object(c.jsx)("p",{className:"dinner-info__address",children:a.address}),Object(c.jsx)("p",{className:"dinner-info__about",children:a.about})]}),Object(c.jsx)("h4",{className:"dinner-info__header",children:"Uczestnicy:"}),d&&Object(c.jsxs)("div",{className:"dinner-info__box",children:[v.map((function(e){var t=e.maker,n=e.id;return Object(c.jsxs)("div",{className:"dinner-info__user-box dinner-info__user-box--maker",children:[Object(c.jsx)("img",{src:t.avatar,alt:"",className:"dinner-info__avatar avatar"}),Object(c.jsxs)("p",{className:"dinner-info__user-name",children:[" ",Object(c.jsxs)(p.b,{to:"/users/".concat(t.id),children:[t.username," "]})]})]},n)})),d.map((function(e){var t=e.id,n=e.invitedUser;return Object(c.jsxs)("div",{className:"dinner-info__user-box",children:[Object(c.jsx)("img",{src:n.avatar,alt:"",className:"dinner-info__avatar avatar"}),Object(c.jsxs)("p",{className:"dinner-info__user-name",children:[" ",Object(c.jsxs)(p.b,{to:"/users/".concat(n.id),children:[n.username," "]})]}),w===n.username&&Object(c.jsx)(A,{id:t})]},t)}))]}),w?T||q?Object(c.jsx)("p",{children:"Ju\u017c do\u0142\u0105czy\u0142e\u015b do tej uczty"}):Object(c.jsx)("button",{className:"primary-btn",onClick:function(){return f.collection("diners").doc(e).collection("invited").add({avatar:W,username:w,id:I}),f.collection("users").doc(m.X).collection("dinners").doc(e).set({date:a.date,name:a.name,time:a.time,city:a.city,id:e}),void f.collection("users").doc(m.X).update({dinners:b.a.firestore.FieldValue.increment(1)})},children:"Do\u0142\u0105cz"}):Object(c.jsx)("p",{children:"Aby do\u0142\u0105czy\u0107 do uczty musisz si\u0119 zalogowa\u0107"})]}):Object(c.jsx)(g,{})},F=n(99),q=n(103),M=n(102),V=n(44),B=Object(V.b)({name:"loginUp",initialState:{loggedUserId:"",loggedUserUsername:"",loggedAvatar:""},reducers:{loginUp:function(e){e.loggedUserId=m.X,e.loggedUserUsername=m.currentUser.displayName},loginOut:function(e){e.loggedUserId="",e.loggedUserUsername=""},getAvatar:function(e,t){e.loggedAvatar=t.payload}}}),W=B.actions,Z=W.loginUp,J=W.loginOut,K=W.getAvatar,G=B.reducer;function R(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var Y=Object(F.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),Q=function(){var e=Y(),t=Object(j.f)(),n=Object(s.useState)(R),a=Object(u.a)(n,1)[0],i=Object(s.useState)(!1),r=Object(u.a)(i,2),l=r[0],d=r[1],b=Object(s.useState)(!1),O=Object(u.a)(b,2),h=O[0],x=O[1],g=Object(s.useState)(!1),_=Object(u.a)(g,2),v=_[0],N=_[1],y=Object(s.useState)(""),S=Object(u.a)(y,2),k=S[0],z=S[1],C=Object(s.useState)(""),I=Object(u.a)(C,2),D=I[0],U=I[1],E=Object(s.useState)(""),T=Object(u.a)(E,2),X=T[0],A=T[1],L=Object(s.useState)(null),P=Object(u.a)(L,2),F=P[0],V=P[1],B=Object(s.useState)(null),W=Object(u.a)(B,2),G=(W[0],W[1],Object(o.b)());Object(s.useEffect)((function(){var e=m.onAuthStateChanged((function(e){e?(V(e),G(Z()),f.collection("users").doc(m.X).onSnapshot((function(e){G(K(e.data().avatar))}))):(V(null),G(J()),K(null))}));return function(){e()}}),[F,k,G]);return Object(c.jsxs)("div",{className:"signup",children:[F&&Object(c.jsx)("p",{children:F.displayName}),Object(c.jsx)(w.a,{className:"modal",open:l,onClose:function(){return d(!1)},children:Object(c.jsx)("div",{style:a,className:e.paper,children:Object(c.jsxs)("center",{children:[Object(c.jsxs)("form",{className:"App__signUp",children:[Object(c.jsx)(q.a,{type:"text",placeholder:"username",value:k,onChange:function(e){return z(e.target.value)}}),Object(c.jsx)(q.a,{type:"text",placeholder:"email",value:X,onChange:function(e){return A(e.target.value)}}),Object(c.jsx)(q.a,{type:"password",placeholder:"password",value:D,onChange:function(e){return U(e.target.value)}}),Object(c.jsx)(M.a,{type:"submit",onClick:function(e){e.preventDefault(),m.createUserWithEmailAndPassword(X,D).then((function(e){d(!1),V(e.user),m.currentUser.updateProfile({displayName:k}),f.collection("users").doc(m.currentUser.X.X).set({username:k,avatar:"https://www.w3schools.com/howto/img_avatar.png",description:"Tw\xf3j opis",dinners:0,likes:0,friends:0,quote:"tw\xf3j cytat"}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)}))})).catch((function(e){var t=e.message;alert(t)}))},children:"Za\u0142\xf3\u017c konto"})]}),Object(c.jsx)("p",{children:"Masz konto? "}),Object(c.jsx)(M.a,{onClick:function(){x(!0),d(!1)},children:"Zaloguj "})]})})}),Object(c.jsx)(w.a,{open:h,onClose:function(){return x(!1)},children:Object(c.jsx)("div",{style:a,className:e.paper,children:Object(c.jsxs)("center",{children:[Object(c.jsxs)("form",{className:"App__signUp",children:[Object(c.jsx)(q.a,{type:"text",placeholder:"email",value:X,onChange:function(e){return A(e.target.value)}}),Object(c.jsx)(q.a,{type:"password",placeholder:"password",value:D,onChange:function(e){return U(e.target.value)}}),Object(c.jsx)(M.a,{type:"submit",onClick:function(e){!function(e){e.preventDefault(),m.signInWithEmailAndPassword(X,D).then((function(e){V(e.user),G(Z())})).catch((function(e){var t=e.message;alert(t)}))}(e),x(!1)},children:"Zaloguj"})]}),Object(c.jsx)("p",{children:"Nie masz konta? "}),Object(c.jsx)(M.a,{onClick:function(){x(!1),d(!0)},children:"Zarejestruj "})]})})}),Object(c.jsx)(w.a,{open:v,onClose:function(){return N(!1)},children:Object(c.jsx)("div",{style:a,className:e.paper,children:Object(c.jsxs)("center",{children:[Object(c.jsx)("p",{children:"Zosta\u0142e\u015b wylogowany/a"}),Object(c.jsx)(M.a,{onClick:function(){return N(!1)},children:"ok"})]})})}),Object(c.jsx)("h1",{children:"Foodie"}),F?Object(c.jsx)("button",{className:"header-btn",onClick:function(){N(!0),m.signOut().then((function(){t.push("/"),G(J())})).catch((function(e){}))},children:"Wyloguj"}):Object(c.jsx)("button",{className:"header-btn",onClick:function(){return x(!0)},children:"Login"}),Object(c.jsx)(p.c,{to:"/dinners",children:Object(c.jsx)("i",{className:"fas fa-utensils header-btn"})}),m.currentUser&&Object(c.jsx)(p.c,{to:"/users/".concat(m.currentUser.X.X),children:Object(c.jsx)("i",{className:"fas fa-user header-btn"})})]})};var H=function(){return Object(c.jsx)(p.a,{children:Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)(Q,{}),Object(c.jsxs)(j.c,{children:[Object(c.jsx)(j.a,{exact:!0,path:"/",children:Object(c.jsx)(d,{})}),Object(c.jsx)(j.a,{exact:!0,path:"/foodie",children:Object(c.jsx)(d,{})}),Object(c.jsx)(j.a,{exact:!0,path:"/users/:id",component:Object(j.h)(U)}),Object(c.jsx)(j.a,{exact:!0,path:"/dinners",children:Object(c.jsx)(X,{})}),Object(c.jsx)(j.a,{path:"/dinners/:id",children:Object(c.jsx)(P,{})}),Object(c.jsx)(j.a,{path:"/make",children:Object(c.jsx)(E,{})}),Object(c.jsx)(j.a,{component:g})]})]})})},$=Object(V.a)({reducer:{takeData:G}});r.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(o.a,{store:$,children:Object(c.jsx)(H,{})})}),document.getElementById("root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.be3e55d6.chunk.js.map